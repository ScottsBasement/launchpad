<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Unblocked Sites Locator</title>
    <style>
        /* CSS styling for the results list */
        #results {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Unblocked Sites Locator</h1>
    <h2>Search for unblocked sites, including games, proxies, etc.</h2>
    <button id="searchButton">Search!</button>
    <div id="results">
        <!-- Results or "Searching..." message will be displayed here -->
    </div>

    <script>
        document.getElementById('searchButton').addEventListener('click', async () => {
            function getBingResults(query) {
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                const targetUrl = `https://www.bing.com/search?q=${query}`;
                
                return fetch(proxyUrl + targetUrl)
                    .then((response) => response.text())
                    .then((data) => new DOMParser().parseFromString(data, 'text/html'))
                    .then((doc) => doc.querySelectorAll('a'))
                    .catch((error) => {
                        console.error('Error occurred during the request:', error);
                        return [];
                    });
            }


            function isUnblockedGame(url, allowedDomains) {
                for (const domain of allowedDomains) {
                    if (url.includes(domain)) {
                        return domain;
                    }
                }
                return null;
            }

            function saveToFile(games, domain) {
                if (games.length > 0) {
                    const outputFileName = `${domain}.txt`;
                    const resultItem = document.createElement('p');
                    resultItem.textContent = `${games.length} Found, Got Em In ${domain}!!`;
                    resultsElement.appendChild(resultItem);
                }
            }

            const query = 'unblocked games links';

            const allowedDomains = [
                '.firebaseapp.com',
                '.pages.dev',
                '.web.app',
                '.vercel.app',
                '.github.io',
                '.netlify.app',
                '.repl.co',
                '.herokuapp.com',
                '.csb.app',
                '.cyclic.app',
            ];

            const resultsElement = document.getElementById('results');
            resultsElement.innerHTML = 'Searching...';

            getBingResults(query)
                .then((links) => {
                    const domainFiles = {};
                    allowedDomains.forEach((domain) => {
                        domainFiles[domain] = new Set();
                    });

                    let noUnblockedGames = true;

                    links.forEach((link) => {
                        const href = link.getAttribute('href');
                        if (href && href.startsWith('http')) {
                            const domain = isUnblockedGame(href, allowedDomains);
                            if (domain) {
                                domainFiles[domain].add(href);
                            }
                        }
                    });

                    resultsElement.innerHTML = ''; // Clear the "Searching..." message

                    for (const domain in domainFiles) {
                        const games = Array.from(domainFiles[domain]);
                        if (games.length > 0) {
                            noUnblockedGames = false;
                            saveToFile(games, domain);
                        }
                    }

                    if (noUnblockedGames) {
                        const noResultsItem = document.createElement('p');
                        noResultsItem.textContent = 'No Unblocked Games :(';
                        resultsElement.appendChild(noResultsItem);
                    }
                });
        });
    </script>
</body>
</html>
